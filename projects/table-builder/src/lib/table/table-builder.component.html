<div
    #tableViewport
    *ngIf="source?.length"
    class="table-grid"
    [style.width]="width"
    [style.height]="height"
    wheelThrottling
>
    <div class="table-grid__body">
        <div
            #column
            inViewport
            *ngFor="let key of columnKeys"
            class="table-grid__column column-is-{{ column['visible'] ? 'visible' : 'invisible' }}"
            (inViewportAction)="column['visible'] = $event.visible"
            [style.height.px]="columnVirtualHeight"
            [style.min-width.px]="clientColWidth"
        >
            <div
                class="table-grid__cell table-grid__header-cell"
                [style.width.px]="column.clientWidth - 1"
                [style.min-height.px]="clientRowHeight"
                [style.max-height.px]="clientRowHeight"
                [style.line-height.px]="clientRowHeight"
                [@fadeAnimation]="'in'"
            >
                <b>{{ key }}</b>
            </div>

            <virtual-scroller
                #scroll
                *ngIf="column['visible']"
                [items]="source"
                [@fadeAnimation]="'in'"
                [scrollAnimationTime]="0"
                [checkResizeInterval]="0"
                (vsUpdate)="updateViewport()"
                [parentScroll]="tableViewport"
                [bufferAmount]="clientBufferAmount"
                [style.height.px]="columnVirtualHeight"
                [executeRefreshOutsideAngularZone]="outsideZone"
            >
                <div
                    class="table-grid__cell"
                    *ngFor="let item of scroll.viewPortItems; trackBy: trackByIdx.bind(this)"
                    [style.min-height.px]="clientRowHeight"
                    [style.max-height.px]="clientRowHeight"
                    [style.line-height.px]="clientRowHeight"
                >
                    {{ item[key] }}
                </div>
            </virtual-scroller>
        </div>
    </div>
</div>
