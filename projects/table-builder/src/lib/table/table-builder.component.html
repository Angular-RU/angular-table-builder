<div
    *ngIf="source?.length && isFirstRendered"
    class="table-grid__root"
    [style.width]="width"
    [class.table-grid__with-vertical-line]="verticalBorder"
    [class.table-grid__root-auto-height]="autoHeightDetect"
    [autoHeight]="{ detect: autoHeightDetect, height: height }"
    [@fadeAnimation]
>
    <div
        #tableViewport
        wheelThrottling
        class="table-grid"
        (scrollOffset)="updateScrollOffset($event)"
        [class.table-grid__native-scrollbar]="nativeScrollbar"
    >
        <div
            #column
            inViewport
            class="table-grid__column"
            *ngFor="let key of displayedColumns"
            [style.height.px]="columnHeight"
            [ngStyle]="columnsSchema[key]?.cssStyle"
            [ngClass]="columnsSchema[key]?.cssClass"
            [style.width.px]="columnsSchema[key]?.width"
            [style.min-width.px]="columnsSchema[key]?.width || clientColWidth"
            [class.table-grid__column--selected-all]="selection.selectionModel.isAll"
            [class.table-grid__column--sticky-left]="columnsSchema[key]?.stickyLeft"
            [class.table-grid__column--sticky-right]="columnsSchema[key]?.stickyRight"
            [class.table-grid__column--is-visible]="column['visible']"
            [class.table-grid__column--is-invisible]="!column['visible']"
            [class.table-grid__column--default-width]="!autoWidth"
            (inViewportAction)="inViewportAction(column, $event)"
        >
            <table-thead
                [column-key]="key"
                [client-row-height]="clientRowHeight"
                [class.table-head__offset]="scrollOffset.offset"
                (resize)="resizeColumn($event, column)"
            ></table-thead>

            <table-tbody
                *ngIf="column['visible']"
                [source]="source"
                [column-key]="key"
                [striped]="striped"
                [primary-key]="primaryKey"
                [selection-entries]="selectionEntries"
                [buffer-amount]="bufferAmount"
                [table-viewport]="tableViewport"
                [enable-selection]="enableSelection"
                [client-row-height]="clientRowHeight"
                [column-virtual-height]="columnVirtualHeight"
            >
            </table-tbody>
        </div>
    </div>
</div>
